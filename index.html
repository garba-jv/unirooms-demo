<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>UniRooms Web – Demo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: Arial, sans-serif;
      background: #f2f4f8;
      color: #222;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 32px 8px;
    }
    .app-container {
      width: 100%;
      max-width: 980px;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 14px rgba(0,0,0,0.08);
      padding: 24px 28px 32px;
    }
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }
    header h1 { font-size: 20px; }
    header small { color: #666; display: block; margin-top: 4px; }
    .tagline { font-size: 13px; color: #777; margin-top: 4px; }
    button, input, select { font-family: inherit; }
    .btn {
      border: none;
      border-radius: 6px;
      padding: 8px 16px;
      cursor: pointer;
      font-size: 14px;
    }
    .btn-primary { background: #0059c8; color: #fff; }
    .btn-secondary { background: #e5e9f0; color: #111827; }
    .btn-danger { background: #e11d48; color: #fff; }
    .btn-sm { padding: 4px 10px; font-size: 12px; }
    .login-card, .content-card {
      border-radius: 10px;
      border: 1px solid #e5e7eb;
      padding: 20px 22px;
      margin-top: 12px;
      background: #fafbff;
    }
    .field { margin-bottom: 12px; }
    label { display: block; font-size: 13px; margin-bottom: 4px; color: #374151; }
    input[type="text"], input[type="password"], input[type="date"], select {
      width: 100%;
      border-radius: 6px;
      border: 1px solid #d1d5db;
      padding: 8px 10px;
      font-size: 14px;
    }
    .alert {
      margin-top: 12px;
      padding: 10px 12px;
      border-radius: 6px;
      font-size: 13px;
    }
    .alert-error {
      background: #fee2e2;
      color: #b91c1c;
      border: 1px solid #fecaca;
    }
    .alert-success {
      background: #ecfdf3;
      color: #166534;
      border: 1px solid #bbf7d0;
    }
    .layout {
      display: grid;
      grid-template-columns: minmax(0, 1.4fr) minmax(0, 1.1fr);
      gap: 20px;
      margin-top: 18px;
    }
    .section-title { font-weight: bold; margin-bottom: 8px; font-size: 15px; }
    table { width: 100%; border-collapse: collapse; font-size: 13px; }
    th, td {
      padding: 8px 6px;
      border-bottom: 1px solid #e5e7eb;
      text-align: left;
    }
    th {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.03em;
      color: #6b7280;
    }
    tr:last-child td { border-bottom: none; }
    .badge {
      border-radius: 999px;
      padding: 2px 8px;
      font-size: 11px;
      display: inline-block;
    }
    .badge-livre { background: #dcfce7; color: #166534; }
    .badge-reservada { background: #fee2e2; color: #b91c1c; }
    .filters {
      display: flex;
      gap: 8px;
      align-items: center;
      margin-bottom: 8px;
      flex-wrap: wrap;
    }
    .filters select { max-width: 220px; }
    .note { font-size: 11px; color: #6b7280; margin-top: 6px; }
    .muted { color: #9ca3af; font-size: 12px; }
    .top-bar {
      display: flex;
      justify-content: flex-end;
      align-items: center;
      margin-top: 10px;
      gap: 8px;
    }
    @media (max-width: 768px) {
      body { align-items: stretch; padding: 8px; }
      .app-container { padding: 18px 16px 24px; }
      .layout { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <div class="app-container">
    <header>
      <div>
        <h1>UniRooms Web</h1>
        <small>Aplicação para Disciplina de Testes e Qualidade de Software</small>
        <div class="tagline">Reserva de salas de estudo na biblioteca (demo para prints).</div>
      </div>
      <div id="userInfo" class="muted"></div>
    </header>

    <!-- LOGIN -->
    <div id="loginView">
      <div class="login-card">
        <div class="section-title">Login</div>
        <div class="field">
          <label for="email">E-mail institucional</label>
          <input id="email" type="text" placeholder="ex: aluno@uni.br" />
        </div>
        <div class="field">
          <label for="password">RA / Senha</label>
          <input id="password" type="password" placeholder="123456" />
        </div>
        <button class="btn btn-primary" id="btnLogin">Entrar</button>
        <div id="loginMessage" class="alert alert-error" style="display:none;margin-top:12px;">
          Credenciais inválidas. Verifique seu e-mail ou RA.
        </div>
        <p class="note" style="margin-top:10px;">
          Para testes, use <strong>aluno@uni.br</strong> e senha <strong>123456</strong>.
        </p>
      </div>
    </div>

    <!-- APP -->
    <div id="appView" style="display:none;">
      <div class="top-bar">
        <span id="loggedSpan"></span>
        <button class="btn btn-secondary btn-sm" id="btnLogout">Sair</button>
      </div>

      <div id="globalMessage" class="alert alert-success" style="display:none;margin-top:12px;"></div>
      <div id="longMessage" class="alert alert-error" style="display:none;margin-top:12px;">
        Mensagem de confirmação MUITO longa para simulação de defeito em telas pequenas:
        após reservar uma sala em horário de pico, o sistema deveria exibir um texto resumido,
        porém esta mensagem está propositalmente extensa e sem quebra adequada para avaliações
        de usabilidade em resoluções mobile durante os testes da disciplina de Qualidade de Software.
      </div>

      <div class="content-card" style="margin-top:14px;">
        <div class="layout">
          <!-- Lista de salas -->
          <section>
            <div class="section-title">Salas de estudo</div>
            <div class="filters">
              <label for="statusFilter">Filtrar por status:</label>
              <select id="statusFilter">
                <option value="todas">Todas</option>
                <option value="livre">Apenas livres</option>
                <option value="reservada">Apenas reservadas</option>
              </select>
            </div>
            <table>
              <thead>
                <tr>
                  <th>Sala</th>
                  <th>Capacidade</th>
                  <th>Status</th>
                  <th>Reservada para</th>
                  <th>Ações</th>
                </tr>
              </thead>
              <tbody id="roomsTableBody"></tbody>
            </table>
            <p class="note">
              Para casos negativos: tente reservar a mesma sala duas vezes seguidas.
            </p>
          </section>

          <!-- Nova reserva -->
          <section>
            <div class="section-title">Nova reserva</div>
            <div class="field">
              <label for="roomSelect">Sala *</label>
              <select id="roomSelect"></select>
            </div>
            <div class="field">
              <label for="dateInput">Data da reserva *</label>
              <input id="dateInput" type="date" />
            </div>
            <div class="field">
              <label for="periodSelect">Período *</label>
              <select id="periodSelect">
                <option value="manha">Manhã</option>
                <option value="tarde">Tarde</option>
                <option value="noite">Noite</option>
              </select>
            </div>
            <button class="btn btn-primary" id="btnReserve">Reservar sala</button>
            <p class="note">
              Use uma data no passado para gerar evidência de validação de data inválida.
            </p>
            <hr style="margin:14px 0;" />
            <div class="section-title" style="font-size:14px;">Simulação para teste não funcional</div>
            <button class="btn btn-secondary btn-sm" id="btnSimulateLongMsg">
              Simular mensagem longa (usabilidade)
            </button>
          </section>
        </div>
      </div>
    </div>

    <script>
      const validUser = { email: 'aluno@uni.br', password: '123456' };
      const rooms = [
        { id: 1, name: 'Sala A - Térreo', capacity: 4, status: 'livre', reservedFor: '' },
        { id: 2, name: 'Sala B - Térreo', capacity: 6, status: 'reservada', reservedFor: 'Grupo TCC Engenharia' },
        { id: 3, name: 'Sala C - 1º andar', capacity: 8, status: 'livre', reservedFor: '' },
        { id: 4, name: 'Sala D - 1º andar', capacity: 10, status: 'livre', reservedFor: '' }
      ];
      let currentUser = null;
      let statusFilter = 'todas';

      const loginView = document.getElementById('loginView');
      const appView = document.getElementById('appView');
      const loginMessage = document.getElementById('loginMessage');
      const emailInput = document.getElementById('email');
      const passwordInput = document.getElementById('password');
      const loggedSpan = document.getElementById('loggedSpan');
      const globalMessage = document.getElementById('globalMessage');
      const longMessage = document.getElementById('longMessage');
      const statusFilterSelect = document.getElementById('statusFilter');
      const roomsTableBody = document.getElementById('roomsTableBody');
      const roomSelect = document.getElementById('roomSelect');
      const dateInput = document.getElementById('dateInput');
      const periodSelect = document.getElementById('periodSelect');

      function renderRooms() {
        roomsTableBody.innerHTML = '';
        roomSelect.innerHTML = '';
        rooms.forEach(room => {
          const option = document.createElement('option');
          option.value = room.id;
          option.textContent = room.name;
          roomSelect.appendChild(option);
        });
        const filtered = rooms.filter(r => {
          if (statusFilter === 'livre') return r.status === 'livre';
          if (statusFilter === 'reservada') return r.status === 'reservada';
          return true;
        });
        filtered.forEach(room => {
          const tr = document.createElement('tr');

          const td1 = document.createElement('td');
          td1.textContent = room.name;
          tr.appendChild(td1);

          const td2 = document.createElement('td');
          td2.textContent = room.capacity + ' pessoas';
          tr.appendChild(td2);

          const td3 = document.createElement('td');
          const badge = document.createElement('span');
          badge.classList.add('badge');
          badge.classList.add(room.status === 'livre' ? 'badge-livre' : 'badge-reservada');
          badge.textContent = room.status === 'livre' ? 'Livre' : 'Reservada';
          td3.appendChild(badge);
          tr.appendChild(td3);

          const td4 = document.createElement('td');
          td4.textContent = room.reservedFor || '-';
          tr.appendChild(td4);

          const td5 = document.createElement('td');
          const b1 = document.createElement('button');
          b1.className = 'btn btn-secondary btn-sm';
          b1.textContent = 'Reservar';
          b1.onclick = () => reserveExisting(room.id);
          const b2 = document.createElement('button');
          b2.className = 'btn btn-danger btn-sm';
          b2.textContent = 'Cancelar';
          b2.style.marginLeft = '4px';
          b2.onclick = () => cancelReservation(room.id);
          td5.appendChild(b1);
          td5.appendChild(b2);
          tr.appendChild(td5);

          roomsTableBody.appendChild(tr);
        });
      }

      function showMessage(text, type='success') {
        globalMessage.textContent = text;
        globalMessage.className = 'alert ' + (type === 'success' ? 'alert-success' : 'alert-error');
        globalMessage.style.display = 'block';
        setTimeout(() => { globalMessage.style.display='none'; }, 3500);
      }

      function handleLogin() {
        const email = emailInput.value.trim();
        const pass = passwordInput.value.trim();
        if (email === validUser.email && pass === validUser.password) {
          currentUser = { email };
          loginView.style.display = 'none';
          appView.style.display = 'block';
          loggedSpan.textContent = 'Logado como: ' + currentUser.email;
          loginMessage.style.display = 'none';
          renderRooms();
        } else {
          loginMessage.style.display = 'block';
        }
      }

      function handleLogout() {
        currentUser = null;
        appView.style.display = 'none';
        loginView.style.display = 'block';
        emailInput.value = '';
        passwordInput.value = '';
        globalMessage.style.display = 'none';
        longMessage.style.display = 'none';
      }

      function reserveExisting(id) {
        const room = rooms.find(r => r.id === id);
        if (!room) return;
        if (room.status === 'reservada') {
          showMessage('Sala já está reservada. Escolha outra sala ou cancele a atual.', 'error');
          return;
        }
        const today = new Date().toISOString().substring(0,10);
        room.status = 'reservada';
        room.reservedFor = 'Reserva rápida em ' + today;
        renderRooms();
        showMessage('Reserva registrada com sucesso.');
      }

      function cancelReservation(id) {
        const room = rooms.find(r => r.id === id);
        if (!room) return;
        if (room.status === 'livre') {
          showMessage('Não há reserva ativa para esta sala.', 'error');
          return;
        }
        room.status = 'livre';
        room.reservedFor = '';
        renderRooms();
        showMessage('Reserva cancelada.');
      }

      function newReservation() {
        const roomId = parseInt(roomSelect.value, 10);
        const room = rooms.find(r => r.id === roomId);
        if (!room) return;

        const dateVal = dateInput.value;
        if (!dateVal) {
          showMessage('Informe uma data para a reserva.', 'error');
          return;
        }

        const today = new Date();
        today.setHours(0,0,0,0);
        const chosen = new Date(dateVal);
        chosen.setHours(0,0,0,0);
        if (chosen < today) {
          showMessage('Data de reserva não pode ser no passado.', 'error');
          return;
        }

        if (room.status === 'reservada') {
          showMessage('Sala já reservada neste horário. Escolha outra.', 'error');
          return;
        }

        const period = periodSelect.value;
        room.status = 'reservada';
        room.reservedFor = 'Reserva em ' + dateVal.split('-').reverse().join('/') + ' (' + period + ')';
        renderRooms();
        showMessage('Reserva criada com sucesso.');
      }

      document.getElementById('btnLogin').addEventListener('click', handleLogin);
      document.getElementById('btnLogout').addEventListener('click', handleLogout);
      document.getElementById('btnReserve').addEventListener('click', newReservation);
      statusFilterSelect.addEventListener('change', () => { statusFilter = statusFilterSelect.value; renderRooms(); });
      document.getElementById('btnSimulateLongMsg').addEventListener('click', () => {
        longMessage.style.display = 'block';
        window.scrollTo({ top: 0, behavior: 'smooth' });
      });

      renderRooms();
    </script>
  </div>
</body>
</html>
